<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Madrasa Result Portal</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; background-color: #f4f4f4; text-align: center; padding: 20px; }
        .container { background: white; max-width: 500px; margin: auto; padding: 20px; border-radius: 10px; box-shadow: 0px 0px 10px rgba(0,0,0,0.1); }
        input, select { width: 90%; padding: 10px; margin: 10px 0; border: 1px solid #ccc; border-radius: 5px; }
        button { background-color: #28a745; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; }
        #resultCard { display: none; margin-top: 20px; padding: 20px; border: 2px solid #333; background: #fff; text-align: left; }
        .download-btn { background-color: #007bff; margin-top: 10px; }
    </style>
</head>
<body>

<div class="container">
    <h2>Madrasa Result Portal</h2>
    <p>Apni details bharein:</p>
    <input type="text" id="rollNo" placeholder="Roll Number">
    <select id="className">
        <option value="">Class Chunein</option>
        <option value="1">Class 1</option>
        <option value="2">Class 2</option>
        </select>
    <button onclick="fetchResult()">Result Dekhein</button>

    <div id="resultCard">
        <div id="printArea">
            <h3 style="text-align:center;">OFFICIAL RESULT CARD</h3>
            <hr>
            <p><strong>Naam:</strong> <span id="resName"></span></p>
            <p><strong>Walid ka Naam:</strong> <span id="resFather"></span></p>
            <p><strong>Roll No:</strong> <span id="resRoll"></span></p>
            <p><strong>Class:</strong> <span id="resClass"></span></p>
            <p><strong>Exam Type:</strong> <span id="resExam"></span></p>
            <p><strong>Year:</strong> <span id="resYear"></span></p>
            <p><strong>Kul Number:</strong> <span id="resMarks"></span></p>
        </div>
        <button class="download-btn" onclick="downloadPDF()">Download Result (PDF)</button>
    </div>
</div>

<script>
    function fetchResult() {
        const rollNo = document.getElementById('rollNo').value;
        const className = document.getElementById('className').value;
        const scriptURL = "https://script.google.com/macros/s/AKfycbwpQXVEwSpUyKj2ndhLSDrci6iPuDJ8jIUV2f2Y1gStZhLNEKpJyA6NQl2ieYxwNy6row/exec";

        if(!rollNo || !className) { alert("Sari details bharein!"); return; }

        fetch(`${scriptURL}?rollNo=${rollNo}&className=${className}`)
        .then(response => response.json())
        .then(data => {
            if(data) {
                document.getElementById('resName').innerText = data.name;
                document.getElementById('resFather').innerText = data.father;
                document.getElementById('resRoll').innerText = data.rollNo;
                document.getElementById('resClass').innerText = data.class;
                document.getElementById('resExam').innerText = data.examType;
                document.getElementById('resYear').innerText = data.year;
                document.getElementById('resMarks').innerText = data.marks;
                document.getElementById('resultCard').style.display = 'block';
            } else {
                alert("Result nahi mila. Roll No check karein.");
            }
        })
        .catch(error => alert("Error: " + error));
    }

    function downloadPDF() {
        const element = document.getElementById('printArea');
        html2pdf().from(element).save('Result.pdf');
    }
</script>

</body>
</html>
